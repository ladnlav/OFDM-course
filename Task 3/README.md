# Отчет к домашнему заданию №3: Искажения канала. Многолучевое распространение

## Квинтэссенция работы
 В этой работе рассмотрено влияние различных канальных искажений (АБГШ, временная рассинхронизация, частотная рассинхронизация и многолучевое распространение) на OFDM-сигнал. Для исследования этого влияния использовались: сравнение АЧХ сигнала, сравнение сигнального созвездия после прохождения канала; рассчёт BER и MER в зависимости от различных значений SNR.

 _**P.s. подпись к картинке/графику появляется при наведении курсора на иллюстрацию.**_

 ![Alt-text](<graphs/task3.png> "Пайп-лайн задания")

 Далее в отчёте рассматриваются различные искажения и проявление на графике АЧХ сигнала и сигнальном созвездии, в качестве некоторой "отправной точки", возьмём АЧХ и сигнальное созвездие в ситуации отсутствия помех - "чистый" канал.
 ![Alt-text](<graphs/clean_sig.png> "График №1. АЧХ при отсутствии помех")
 ![Alt-text](<graphs/sc_clean.png> "График №2. Сигнальное созвездие при отсутствии помех")

## Аддитивный белый Гауссовский шум (АБГШ)
 Рассмотрение помех начнём с АБГШ. Итак, при `SNR=25 dB` имеем следующие графики:
 ![Alt-text](<graphs/25snr_sig.png> "График №3. АЧХ при АБГШ (SNR=25dB)")
 ![Alt-text](<graphs/sc_noise.png> "График №4. Сигнальное созвездие при АБГШ (SNR=25dB)")

 #1. Как можно видеть, АЧХ приобрела чётко выраженные флуктуации по всей полосе спектра. В то же время на сигнальном созвездии исходные точки превратились в "облака" вокруг исходных точек. Очевидно, что при увеличении мощности накладываемого шума, амплитуда появившихся флуктуаций на графике АЧХ и размер "облаков" будут становиться больше.

 #2. Кроме того, была рассчитана такая характеристика сигнала, как Modulation-Error-Ratio (MER). Эта характеристика показывает отношение мощности вектора "идеальной точки" к вектору ошибки по отношению к этой самой "идеальной точке" (если мы рассматриваем MER для одной конкретной IQ-точки принятого сигнала - так, там подразумаевается отношение сумм по всем точкам). Собственно, в этом и состоит отличие MER от SNR (signal-to-noise-ratio), ведь вторая характеристика непосредственно показывает отношение мощности сигнала к мощности шума. И хорошо известно, что MER и SNR могут не совпадать по объективным причинам (например, когда ошибка настолько велика, что мы определяем "идеальную точку" для данной принятой IQ-точки неверно). Однако, причина различия MER и SNR на картинке ниже в другом. 
 ![Alt-text](<graphs/info.png> "Различие MER и SNR")
 Эта причина заключается в том, что в моей реализации этого задания SNR задаёт мощность шума, которая размазывается на весь OFDM-сигнал. В то же самое время MER рассчитывается только на основании тех IQ-точек, которые по сути содержат в себе реальные данные (`400 - по количеству поднесущих`). Таким образом, остальные `Nfft-400 точек` при расчёте MER не учитываюся, хотя и "впитывают" часть мощности шума.

 #3. Также в рамках задания была рассчитана характеристика BER(SNR) для диапазона шумов от `0dB до 30dB`.
 ![Alt-text](<graphs/ber(snr).png> "График №5. Характеристика BER(SNR)")
 На графике можно наблюдать ожидаемое поведение кривой - "водопадный спад". И уже в районе `SNR = 15 dB` можно видеть нулевую вероятность битовой ошибки.

## Временная рассинхронизация (STO)
 Теперь перейдём к рассмотрению эффекта временной рассинхронизации (sampling time offset - STO).
 ![Alt-text](<graphs/3sto_sig.png> "График №6. АЧХ при STO=3")
 ![Alt-text](<graphs/sc_sto.png> "График №7. Сигнальное созвездие при STO=3")

 Как можно видеть, АЧХ исходного сигнала теперь вряд ли можно вообще узнать. Т.е. справедливо нарушение ортогональности между символами, что привело к межсимвольной интерференции (ISI). На сигнальном созвездии это проявляется в форме закручивания созвездия.

## Частотной рассинхронизация (CFO)
 Теперь настало время рассмотреть эффект частотной рассинхронизации. Стоит отметить, что этот эффект зависит от величины CFO в расстояниях между поднесущими, а именно, эта величина может быть дробной, а может быть целочисленной. И в зависимости от этого мы будем наблюдать разные эффекты. Для начала взглянем, что вообще происходит с нашими графиками при `CFO = 5`.
 ![Alt-text](<graphs/5cfo_sig.png> "График №8. АЧХ при CFO=5")
 ![Alt-text](<graphs/sc_cfo.png> "График №9. Сигнальное созвездие при CFO=5")

 #1. На графике АЧХ сразу можно отметить, что полоса поднесущих, которые содержат реальные данные, сместилась на заданное количество отсчётов. При этом на графике сигнального созвездия можно наблюдать поворот нашего созвездия, а также появление нулевых точек - оно и понятно, ведь теперь вместо первых 5 отсчётов содержащих данные мы получили нулевые. Но это не вся правда. Рассмотрим другие значения CFO.

 ![Alt-text](<graphs/001cfo_sig.png> "График №10. АЧХ при CFO=1% от расстояния между поднесущими")
 ![Alt-text](<graphs/001sc_cfo.png> "График №11. Сигнальное созвездие при CFO=1% от расстояния между поднесущими")

 ![Alt-text](<graphs/01cfo_sig.png> "График №12. АЧХ при CFO=0.1 от расстояния между поднесущими")
 ![Alt-text](<graphs/01sc_cfo.png> "График №13. Сигнальное созвездие при CFO=0.1 от расстояния между поднесущими")

 ![Alt-text](<graphs/100cfo_sig.png> "График №12. АЧХ при CFO=100 расстояний между поднесущими")
 ![Alt-text](<graphs/100sc_cfo.png> "График №13. Сигнальное созвездие при CFO=100 расстояний между поднесущими")

 #2. Выше приведены графики для следующих значений CFO в расстояниях между поднесущими: `0,01; 0,1; 100`. Обозначим целочисленные значения как IFO (integer frequency offset), а дробные как FFO (fractional frequency offset). Так вот, наблюдается следующая тендеция:
 * FFO: невооруженным глазом заметить какие-либо изменения на графике АЧХ трудно; но в то же время сигнальное созвездие, конкретнее, каждая точка исходного созвездия переходит в "облачные квадратики" вокруг исходной точки;
 * IFO: явно заметен сдвиг на графике АЧХ на заданное количество отсчётов; а на сигнальном созвездии изменения только в добавлении нулевых точек.

 Из всех описанных выше изменений можно сделать следующий вывод: **при IFO ортогональность между символами сохраняется, но теряется часть данных; в то же время при CFO ортогональность между символами нарушается, что приводит к межсимвольной интерференции (ISI) - бОльшим трудностям при попытке извлечь данные из сигнала**.

## Многолучевое распространение
 И наконец рассмотрим эффект многолучевого распространения. 
 ![Alt-text](<graphs/mp_sig.png> "График №14. АЧХ при многолучевом распространении")
 ![Alt-text](<graphs/sc_mp.png> "График №15. Сигнальное созвездие при многолучевом распространении")

 На графике АЧХ видно, что теперь теперь наш сигнал приобрёл частнотные замирания (fading), следовательно, имеем частотно-селективный канал, а также прослеживаются три пика, которые соответствуют трём лучам, выражающимся в трёх тапах в импульсной характеристике канала: `channel_taps = [0, 1; 4, 0.6; 10, 0.3]`. В свою очередь на сигнальном созвездии "полный бардак" и определить, где и что находится практически невозможно - из чего можно сделать вывод, что данные потеряны. Это произошло из-за изменений амплитуды на некоторых частотах. Однако, в дальнейшем этот эффект может быть скомпенсирован в рамках процедуры эквалайзинга.